---
title: "p8105_hw2_tp2806"
author: "Tejashree Prakash"
date: 2025-09-29
output: github_document
---

```{r setup, include=FALSE}
#Load libraries and data
library(tidyverse)
library(lubridate)
```

## Problem 1 

```{r}
#Download and clean pols data
pols =
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>%
  separate(mon, into = c("year", "month", "day"), sep = "-", convert = TRUE) %>%
  mutate(month = month.name[month]) %>% #Convert numbers to month names 
  mutate(president = case_when( #Create case to show gop or dem president 
    prez_gop == 1 ~ "gop",
    prez_dem == 1 ~ "dem"
  )) %>%
  select(-prez_dem, -prez_gop, -day)

#Download and clean snp data 
snp = 
  read_csv("data/fivethirtyeight_datasets/snp.csv") %>%
  mutate(
    date = mdy(date) #turn into as.date format 
  ) %>%
  separate(date, into = c("year", "month", "day"), sep = "-", convert = TRUE) %>%
  mutate(month = month.name[month]) %>%
  select(year, month, close, -day)

#Download and clean unemployment data
unemployment = 
  read_csv("data/fivethirtyeight_datasets/unemployment.csv") %>%
  pivot_longer(
    cols = Jan:Dec,
    names_to = "month",
    values_to = "unemployment_percentage"
  ) %>% 
  mutate(
    month = month.name[match(month, month.abb)] #change abbreviated month names to full month names
  ) %>%
  rename(year = Year) #make the capitalization of columns consistent 
```

Merging all the datasets together. 

```{r}
#Merge datasets - starting with snp into pols 
merge <- 
  left_join(pols, snp, by = join_by(year, month)) #want to join by both year and month

final_merge <- 
  left_join(merge, unemployment, by = join_by(year, month)) 
```

The 'snp' dataset contains 787 observations and 2 variables - the date and the closing values of the S&P stock index on that date. The 'unemployment' dataset was converted to long form, now containing unemployment percentage according to each year and month. The 'pols' dataset contains 822 observations and 9 variables - the key variables include month, year, and party of the president elect. The resulting dataset, after merging, reflects the base structure for the pols dataset, with the unique columns from 'snp' and 'unemployment' added onto it based on matching month and year. Therefore, any values from 'snp' and 'unemployment' that did not have a corresponding month/year with 'pols' was not included in the final dataset. 


## Problem 2
